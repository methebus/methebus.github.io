webpackJsonp([1],{"+ygv":function(t,e){},Ek1K:function(t,e){},M2Bo:function(t,e){},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=n("//Fk"),i=n.n(s),a=n("7+uW"),o=n("Dd8w"),r=n.n(o),c=n("NYxO"),l=n("zxL1"),u=n.n(l),d={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"user-panel"},[e("div",{staticClass:"user-name"},[this._v("\n    "+this._s(this.user.login)+"\n  ")])])},staticRenderFns:[]};var h=n("VU/8")({name:"UserPanel",props:["user"]},d,!1,function(t){n("yZAU")},"data-v-68b8c20d",null).exports,f={name:"NavMenu",components:{"app-logo":u.a,"user-panel":h},computed:r()({},Object(c.b)(["is_logged","login"]),{user:function(){return{login:this.login||""}}})},p={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"nav-menu"},[e("div",{staticClass:"logo-wrapper"},[e("app-logo",{staticClass:"logo"})],1),this._v(" "),this.is_logged?e("user-panel",{attrs:{user:this.user}}):this._e()],1)},staticRenderFns:[]};var m={name:"App",components:{"nav-menu":n("VU/8")(f,p,!1,function(t){n("cxMA")},"data-v-fc98e896",null).exports},created:function(){this.checkUser()},methods:{getUser:function(){this.$store.dispatch("get_disk")},checkUser:function(){this.is_logged&&""==this.login&&this.getUser()}},computed:r()({},Object(c.b)(["login","is_logged"])),watch:{$route:{handler:function(){this.checkUser()},deep:!0}}},g={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("nav-menu"),this._v(" "),e("router-view")],1)},staticRenderFns:[]};var v=n("VU/8")(m,g,!1,function(t){n("sZoW")},null,null).exports,_=n("/ocq"),A={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"message",class:{centered:this.centered}},[e("div",{staticClass:"message-title"},[this._v("\n    "+this._s(this.title)+"\n  ")]),this._v(" "),e("div",{staticClass:"message-content"},[this._t("default")],2)])},staticRenderFns:[]};var k=n("VU/8")({name:"Message",props:["centered","title"]},A,!1,function(t){n("Ek1K")},"data-v-11981121",null).exports,b={name:"Login",components:{message:k},computed:r()({},Object(c.b)(["login_link"])),beforeCreate:function(){if(this.$route.hash.length>1){var t=this.$route.hash.match(/(access_token=)([0-9a-zA-Z\-]*)&/);null!==t&&void 0!==t[2]&&(this.$store.commit("loginUser",t[2]),this.$router.push({name:"Disk"}))}}},y={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"page"},[e("message",{attrs:{centered:!0,title:"You are not authorized"}},[this._v("\n    To see the contents of your Yandex Disk, click on the button below and log in to your Yandex account:\n    "),e("a",{staticClass:"action-bttn",attrs:{href:this.login_link}},[this._v("\n      Sign in\n    ")])])],1)},staticRenderFns:[]};var C=n("VU/8")(b,y,!1,function(t){n("M2Bo")},null,null).exports,x=new a.a,U={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"loader"})},staticRenderFns:[]};var F=n("VU/8")({name:"Loader"},U,!1,function(t){n("evbJ")},"data-v-32d8c3ce",null).exports,V={name:"Breadcrumbs",computed:r()({},Object(c.b)(["path"]))},L={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"breadcrumbs"},[n("router-link",{staticClass:"breadcrumbs-item",attrs:{to:"/yandex-files/disk/"}},[t._v("\n    Home\n  ")]),t._v(" "),t._l(t.path,function(e,s){return n("router-link",{key:s,staticClass:"breadcrumbs-item",attrs:{to:"/yandex-files/disk/"+t.path.slice(0,s+1).join("/")}},[t._v("\n    "+t._s(e)+"\n  ")])})],2)},staticRenderFns:[]};var w=n("VU/8")(V,L,!1,function(t){n("g7d0")},"data-v-7b180fdb",null).exports,R={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"files-loader-wrapper"},[e("div",{staticClass:"files-loader"})])}]};var $={name:"FilesList",props:["resources","loading","cached"],components:{"files-loader":n("VU/8")({name:"FilesLoader"},R,!1,function(t){n("+ygv")},"data-v-67e4521e",null).exports},methods:{formatFilesize:function(t){return t<1024?t+" bytes":t<1048576?(t/1024).toFixed(2)+" KB":t<1073741824?(t/1048576).toFixed(2)+" MB":(t/1073741824).toFixed(2)+" GB"},openFolder:function(t){x.$emit("openFolder",t)}}},E={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"files-list"},[t.loading?s("files-loader"):t._e(),t._v(" "),0!=t.resources.length||t.loading&&!t.cached?t._e():s("div",{staticClass:"files-msg"},[t._v("\n    Folder is empty\n  ")]),t._v(" "),t._l(t.resources,function(e){return s("div",{staticClass:"files-item",class:{folder:"dir"==e.type,file:"file"==e.type},attrs:{title:e.name},on:{dblclick:function(n){"dir"==e.type&&t.openFolder(e.path)}}},["dir"==e.type?s("img",{staticClass:"file-icon",attrs:{src:n("nLVK")}}):t._e(),t._v(" "),s("div",{staticClass:"file-details"},[s("div",{staticClass:"file-name"},[t._v("\n        "+t._s(e.name)+"\n      ")]),t._v(" "),"file"==e.type?s("div",{staticClass:"file-info"},[t._v("\n        "+t._s(t.formatFilesize(e.size))+"\n      ")]):t._e()])])})],2)},staticRenderFns:[]};var z={name:"Disk",data:function(){return{loading:!1}},components:{"app-loader":F,breadcrumbs:w,"files-list":n("VU/8")($,E,!1,function(t){n("Q0kf")},"data-v-6305b76c",null).exports},computed:r()({},Object(c.b)(["token","resources","path","url_path","cache"]),{contents:function(){var t=this;if(0!=this.resources.length)return this.resources;var e=this.cache.find(function(e){return e.path==t.url_path});return void 0!==e?e.items:[]},cached:function(){var t=this;return void 0!==this.cache.find(function(e){return e.path==t.url_path})}}),created:function(){var t=this;this.setPathFromUrl(),this.loadResources(),x.$on("openFolder",function(e){t.$router.push("/yandex-files/disk/"+e.substr(6))})},methods:{setPathFromUrl:function(){var t=this.$route.path;"/"==t?(t=[],document.title="Disk"):(t=decodeURIComponent(t).split("/").splice(2),document.title=t[t.length-1]),this.$store.commit("setPath",t)},loadResources:function(){var t=this;this.$store.commit("updateResources",[]),this.loading=!0,this.$store.dispatch("get_resources").then(function(e){t.loading=!1},function(e){t.loading=!1,404==e.status&&t.$router.push("/yandex-files/")})}},watch:{$route:{handler:function(){this.setPathFromUrl(),this.loadResources()},deep:!0}}},M={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"page"},[e("breadcrumbs",{attrs:{path:this.path}}),this._v(" "),e("files-list",{attrs:{resources:this.contents,loading:this.loading,cached:this.cached}})],1)},staticRenderFns:[]};var D=n("VU/8")(z,M,!1,function(t){n("NYeT")},null,null).exports,S={name:"NotFound",components:{message:k}},j={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"page"},[e("message",{attrs:{centered:!0,title:"Oops"}},[this._v("\n    Seems like you played with the URL and accidentally entered\n    an incorrect value. Click below to continue working with the disk.\n    "),e("router-link",{staticClass:"action-bttn",attrs:{to:"/yandex-files/disk/"}},[this._v("\n      Go home\n    ")])],1)],1)},staticRenderFns:[]};var B=n("VU/8")(S,j,!1,function(t){n("hrsr")},null,null).exports;a.a.use(_.a);var I=new _.a({routes:[{path:"/yandex-files/",redirect:{name:"Disk"}},{path:"/yandex-files/disk",redirect:{name:"Disk"}},{path:"/yandex-files/disk/*",name:"Disk",component:D,meta:{requiresAuth:!0,title:"Disk"}},{path:"/yandex-files/login",name:"Login",component:C,meta:{guestOnly:!0,title:"Login"}},{path:"*",name:"NotFound",component:B,meta:{title:"Not Found"}}],mode:"history"}),N=n("mw3O"),O=n.n(N),Y=n("mtWM"),P=n.n(Y),T={oauth:"https://oauth.yandex.ru",disk:"https://cloud-api.yandex.net:443/v1"},W={client_id:"51485b1c1aed4713a4d7772af911e74b"},J={state:{login:localStorage.getItem("u")||"",password:"",token:localStorage.getItem("t")||"",isLogged:!!localStorage.getItem("t"),endpoints:{login:T.oauth+"/authorize?response_type=token&client_id="+W.client_id+"&redirect_uri=https://sidletski.github.io/yandex-files/login"}},actions:{},mutations:{updateLogin:function(t,e){t.login=e},updatePassword:function(t,e){t.password=e},saveLogin:function(t,e){localStorage.setItem("u",e),t.login=e},loginUser:function(t,e){localStorage.setItem("t",e),t.token=e,t.isLogged=!0},logoutUser:function(t){localStorage.removeItem("t"),localStorage.removeItem("u"),t.isLogged=!1,t.id="",t.login="",t.token=null}},getters:{is_logged:function(t){return t.isLogged},login_link:function(t){return t.endpoints.login},login:function(t){return t.login},token:function(t){return t.token}}},K={state:{path:[],resources:[],cache:[],endpoints:{get_disk:T.disk+"/disk",get_resources:T.disk+"/disk/resources"}},actions:{get_disk:function(t){var e=t.commit,n=t.state,s=t.rootState;return new i.a(function(t,i){P()({method:"get",headers:{"Content-Type":"application/json",Authorization:s.auth.token},url:n.endpoints.get_disk}).then(function(n){void 0!==n.data.user&&void 0!==n.data.user.login&&e("saveLogin",n.data.user.login,{root:!0}),t(n.data)}).catch(function(t){i(t.response)})})},get_resources:function(t){var e=t.commit,n=t.state,s=t.getters,a=t.rootState;return new i.a(function(t,i){var o={path:s.url_path,limit:1e4};P()({method:"get",headers:{"Content-Type":"application/json",Authorization:a.auth.token},url:n.endpoints.get_resources+"?"+O.a.stringify(o)}).then(function(n){e("updateCache",{path:n.data._embedded.path,items:n.data._embedded.items}),e("updateResources",n.data._embedded.items),t(n.data._embedded)}).catch(function(t){i(t.response)})})}},mutations:{setPath:function(t,e){t.path=e},clearPath:function(t){t.path=[]},updateCache:function(t,e){var n=t.cache.findIndex(function(t){return t.path==e.path});-1==n?t.cache.push({path:e.path,items:e.items}):t.cache[n].items=e.items},updateResources:function(t,e){t.resources=e},clearResources:function(t){t.resources=[]}},getters:{url_path:function(t){return"disk:/"+t.path.join("/")},path:function(t){return t.path},resources:function(t){return t.resources},cache:function(t){return t.cache}}};a.a.use(c.a);var H=new c.a.Store({modules:{auth:J,disk:K},strict:!0});a.a.config.productionTip=!1,P.a.interceptors.response.use(function(t){return t},function(t){return void 0!==t.response&&401==t.response.status?(H.commit("logoutUser"),I.push("/yandex-files/login")):i.a.reject(t)}),I.beforeEach(function(t,e,n){t.matched.some(function(t){return t.meta.requiresAuth})?H.state.auth.isLogged?n():n("/login"):t.matched.some(function(t){return t.meta.guestOnly})&&H.state.auth.isLogged?n("/"):n()}),I.afterEach(function(t,e){document.title=t.meta.title}),new a.a({el:"#app",router:I,store:H,components:{App:v},template:"<App/>"})},NYeT:function(t,e){},Q0kf:function(t,e){},cxMA:function(t,e){},evbJ:function(t,e){},g7d0:function(t,e){},hrsr:function(t,e){},nLVK:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAYCAYAAADtaU2/AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4goDATIa3o1gWgAAAJ1JREFUSMftlrENAkEMBOeOl4go4GjCLVAIFlVABg8igD7cCDVcDw9dAMkjQQKIE/eJJ1+NVg68QVXHwB6YA4nP7MxsSyEjETkAS2DyZWYmIiHnfCoRR0B/yLWqeiwRB1W9UY8LYMC6oS4JWAHXyDAsXhqbWfin7emsaajGuNjFLnaxi138doF0wLSyt4v9FKmNNcDm8acrND/3Rds7k78eqvl8OpoAAAAASUVORK5CYII="},sZoW:function(t,e){},yZAU:function(t,e){},zxL1:function(t,e){t.exports={render:function(){var t=this.$createElement,e=this._self._c||t;return e("svg",{staticClass:"logo__svg",attrs:{width:"112",height:"30"}},[e("path",{attrs:{d:"M18.957 21.862c-.444.697-1.3 1.268-2.156 1.268-1.268 0-1.87-1.205-1.87-3.044 0-2.06.665-3.423 3.74-3.423h.286v5.199zm2.44-.476v-7.513c0-3.867-1.553-5.072-4.374-5.072-1.617 0-3.075.666-3.804 1.268l.475 2.188c.825-.73 1.902-1.395 3.17-1.395 1.395 0 2.093.887 2.093 2.98v.95h-.35c-4.469 0-6.212 2.156-6.212 5.58 0 3.138 1.553 4.85 3.835 4.85 1.395 0 2.283-.602 2.98-1.49h.159c.031.412.127.92.222 1.268h2.092a22.987 22.987 0 0 1-.285-3.614zm5.548-8.78c.57-.793 1.458-1.586 2.504-1.586.951 0 1.49.412 1.49 1.617V25h2.505V12.415c0-2.44-1.11-3.614-3.202-3.614-1.49 0-2.695.983-3.138 1.585h-.159V8.991h-2.473V25h2.473V12.605zm13.79 12.616c1.3 0 2.187-.602 2.884-1.49h.159l.19 1.268h1.839V2.334h-2.473v7.07c-.476-.35-1.268-.603-2.029-.603-3.202 0-5.42 2.885-5.42 8.813 0 4.945 1.711 7.608 4.85 7.608zm2.599-3.329c-.412.634-1.078 1.237-2.314 1.237-1.807 0-2.504-2.283-2.504-6.023 0-3.265.95-6.277 2.948-6.277.824 0 1.363.254 1.87.76v10.303zm14.106 2.03l-.57-1.903c-.634.444-1.649 1.078-3.043 1.078-1.966 0-2.98-1.902-2.98-5.516h6.657V16.22c0-5.42-1.744-7.418-4.406-7.418-3.392 0-4.819 3.74-4.819 8.876 0 4.914 2.029 7.545 5.326 7.545 1.585 0 2.821-.507 3.835-1.3zM53.098 10.83c1.426 0 1.87 1.997 1.87 4.723h-4.09c.159-2.853.698-4.723 2.22-4.723zM65.84 9.023l-2.187 5.801-2.06-5.8h-2.569l3.012 7.702L58.708 25h2.441l2.41-6.594L66.03 25h2.57l-3.329-8.496 2.98-7.48h-2.41zM75.763 25h2.314c5.009 0 8.4-4.501 8.4-12.173 0-7.861-3.581-10.493-8.051-10.493h-2.663V25zm2.663-21.366c3.55 0 6.435 2.314 6.435 9.32 0 6.942-2.726 10.746-6.752 10.746h-.761V3.634h1.078zm11.697 2.25c.539 0 1.015-.443 1.015-1.014 0-.538-.476-1.046-1.015-1.046-.57 0-1.014.508-1.014 1.046 0 .571.444 1.015 1.014 1.015zm-.76 3.14V25h1.49V9.023h-1.49zm7.164 16.293c2.092 0 3.899-1.458 3.899-3.994 0-4.47-5.548-5.801-5.548-9.257 0-1.394 1.046-2.155 2.22-2.155 1.109 0 1.901.412 2.599 1.173l.412-1.363c-.54-.444-1.522-1.015-3.075-1.015-1.744 0-3.487 1.141-3.487 3.55 0 4.058 5.484 5.611 5.484 9.257 0 1.363-.951 2.6-2.536 2.6-1.522 0-2.283-.54-3.043-1.205l-.317 1.3c.602.507 1.616 1.109 3.392 1.109zm7.925-8.59L109.999 25h1.617l-5.643-8.559 5.262-7.418h-1.426l-5.357 7.513V2.334h-1.49V25h1.49v-8.274z"}}),e("path",{attrs:{fill:"red",d:"M8.115 25v-8.02L14.011-.011h-2.504L6.911 13.556 2.916 2.334H.19l5.42 14.55V25z"}})])}}}},["NHnr"]);
//# sourceMappingURL=app.c911a35ad2d371305999.js.map